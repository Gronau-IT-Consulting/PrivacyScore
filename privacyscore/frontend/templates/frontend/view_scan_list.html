{% extends 'frontend/base.html' %}
{% load static %}
{% load scan_list %}
{% load i18n %}

{% block title %}PrivacyScore{% endblock title %}

{% block additional_css %}
<style type="text/css">
.align-right {
  text-align: right;
}

.rating-good {
  background: #00C022;
}

.rating-warning {
  background: #FFC517;
}

.rating-bad {
  background: #FF2C17;
}
</style>
{% endblock additional_css %}

{% block content %}
    <h1>
      {{ scan_list.name }}
    </h1>


    <div class="row">
      <div class="col-md-9">
        <div class="box">
          <span class="glyphicon glyphicon-info-sign" data-toggle="tooltip" title="{% trans 'Description' %}" id="tooltipDescription"></span>
          <span id="description">{{ scan_list.description }}</span>
        </div>
        <div class="box">
          <span class="glyphicon glyphicon-tags" data-toggle="tooltip" title="{% trans 'Tags' %}" id="tooltipTags"></span>
          <span id="tags">{{ scan_list.tags_as_str }}</span>
        </div>
        <div class="box">
          <span class="glyphicon glyphicon-time" data-toggle="tooltip" title="Zeit" id="tooltipTime">{{ scan_list.last_scan_datetime|date:"j.n.Y H:i" }}</span>
          <span id="startdate"></span> <i class="fa fa-long-arrow-right"></i>
        </div>
        <div class="box">
          <i class="fa fa-hand-o-right" data-toggle="tooltip" id="popularThirdParties"></i>
          <a id="popularThirdPartiesButton" href="TODO" style="color:black;">

            <span id="popularThirdPartiesDiv">Häufige Third Parties</span>
          </a>
        </div>
        <div class="well-sm result">
           <div class="row result-body" id="dashboard" style="display:none; padding-top:15px;">
            <div class="col-md-3">
              <div class="result-value"></div>
              <div id="dashboardScore">Durchschnittliche Bewertung</div>
              </div>
              <div class="col-md-3">
              <div class="result-value"></div>
              <div id="dashboardHTTPS">der Seiten bieten HTTPS als Standard an</div>
              </div>
              <div class="col-md-3">
              <div class="result-value"></div>
              <div id="dashboardCookies">Durchschnittliche Anzahl an Cookies</div>
              </div>
              <div class="col-md-3">
              <div class="result-value"></div>
              <div id="dashboardThirdParties">Durchschnittliche Anzahl an Third Parties</div>

              </div>
          </div>
        </div>
      </div>

      <div class="col-md-3">


        <a class="btn btn-default" onclick="deleteList()" role="button" id="delete_list" style="width:100%; display:none;">Liste löschen</a>
        <a class="btn btn-default" onclick="scanAgain()" role="button" id="scan_again" style="width:100%;">Nochmal scannen</a>
        <a href="{% url 'frontend:scan_list' %}" class="btn btn-default" role="button" id="new_list" style="width:100%;">Neue Liste aus dieser erstellen</a>

         <div class="form-group">
          <label id="labelShowScan">Scan anzeigen</label>
          <select onchange="location = this.options[this.selectedIndex].value;" class="form-control" id="oldNewScans">
          </select>

        <div id="compareDiv">
        <input type="checkbox" id="compareCheckbox" value="" onclick="toggleCompare();">
          <label id="labelCompareScan">Vergleichs-Scan</label>
          <select onchange="dropdownAction()" class="form-control" id="compareScans">
          </select>
        </div>
        </div>
      </div>
    </div>

  <table class="table table-striped table-bordered table-hover">
    <tr>
      <th>{% trans 'URL' %}</th>
      {% for column in scan_list.ordered_columns %}
        <th>{{ column.name }}</th>
      {% endfor %}
      {% for group in result_groups %}
        <th>{{ group }}</th>
      {% endfor %}
      <th class="align-right">{% trans 'Scan time' %}</th>
    </tr>

    {% for site in sites %}
      <tr>
        <td>
          <a href="{% url 'frontend:view_site' site.pk %}">
            {{ site.url }}
          </a>
        </td>
        {% for column_value in site|ordered_site_columns:scan_list %}
          <th>{{ column_value.value }}</th>
        {% endfor %}
        {# TODO: sorting? Probably do not do this in template at all #}
        {% for rating in site.last_scan.result.evaluate_sorted %}
          <td class="rating-{{ rating.group_rating }}">
            {{ rating.group_rating }}
            {%  blocktrans with good=rating.good total=rating.good|add:rating.bad %}
              ({{ good }}/{{ total }} good)
            {% endblocktrans %}
          </td>
        {% endfor %}
        <td class="align-right">{{ site.last_scan_datetime }}</td>
      </tr>
    {% endfor %}
  </table>

{% endblock content %}
